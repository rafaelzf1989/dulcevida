<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Dulce Vida - Tienda de Panetelas</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Estilos generales y mejoras del carrito -->
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      background: #fafafa;
      color: #222;
    }
    header {
      background: #25d366;
      color: #fff;
      padding: 22px 0 12px 0;
      text-align: center;
      margin-bottom: 18px;
      box-shadow: 0 4px 10px #25d36622;
    }
    h1 {
      margin: 0;
      font-size: 2em;
      letter-spacing: 1px;
    }
    #productos {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 2vw;
      padding: 10px 3vw 22px 3vw;
    }
    .producto {
      background: #fff;
      border: 1.5px solid #eee;
      border-radius: 12px;
      box-shadow: 0 1px 10px #25d36610;
      padding: 16px;
      max-width: 250px;
      width: 93vw;
      text-align: center;
      margin-bottom: 20px;
      position: relative;
      transition: box-shadow 0.17s;
    }
    .producto:active, .producto:hover {
      box-shadow: 0 4px 20px #25d36640;
      border-color: #25d36677;
    }
    .producto img {
      width: 120px;
      height: 120px;
      object-fit: contain;
      margin-bottom: 7px;
      border-radius: 7px;
      box-shadow: 0 2px 4px #25d36622;
    }
    .producto .etiqueta {
      position: absolute;
      top: 8px;
      right: 8px;
      background: #e74c3c;
      color: #fff;
      font-size: 0.9em;
      padding: 2px 8px;
      border-radius: 8px;
      z-index: 2;
      letter-spacing: 0.5px;
    }
    .producto.agotado {
      opacity: 0.5;
    }
    .producto button {
      background: #25d366;
      color: #fff;
      border: none;
      border-radius: 5px;
      padding: 7px 15px;
      font-size: 1em;
      margin-top: 10px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .producto button:disabled {
      background: #aaa;
      cursor: not-allowed;
    }
    .control-cantidad {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 7px 0 0 0;
      gap: 6px;
    }
    .control-cantidad button {
      background: #25d366;
      color: #fff;
      border: none;
      border-radius: 3px;
      width: 28px;
      height: 28px;
      font-size: 1.15em;
      cursor: pointer;
    }
    .control-cantidad button:disabled {
      background: #ccc;
    }
    .control-cantidad span {
      font-size: 1.1em;
      font-weight: 600;
      min-width: 24px;
      display: inline-block;
      text-align: center;
    }

    /* Carrito y mejoras */
    #carrito {
      max-width: 500px;
      margin: 28px auto 0 auto;
      text-align: left;
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 2px 18px #25d36611;
      padding: 24px 16px 24px 16px;
      position: relative;
      min-height: 180px;
    }
    #carrito h2 {
      margin-top: 0;
      text-align: center;
      letter-spacing: 1px;
    }
    #carritoVacio {
      color: #888;
      font-size: 1.1em;
      margin: 18px 0;
      text-align: center;
    }
    #vaciarCarrito {
      background: #e74c3c;
      color: #fff;
      border: none;
      border-radius: 5px;
      padding: 8px 16px;
      margin: 12px 0 18px 0;
      cursor: pointer;
      font-size: 1em;
      transition: background 0.2s;
      display: none;
    }
    #vaciarCarrito:hover, #vaciarCarrito:focus {
      background: #c0392b;
    }
    #resumenTotales {
      background: #f7f7f7;
      border: 2px solid #25D366;
      border-radius: 10px;
      padding: 16px 20px;
      margin: 12px 0 0 0;
      font-size: 1.1em;
      box-shadow: 0 4px 14px rgba(37,211,102,0.07);
      position: sticky;
      top: 10px;
      z-index: 10;
    }
    .carrito-item-animado {
      animation: flashCarrito 0.5s;
    }
    @keyframes flashCarrito {
      0% { background: #e8ffe7;}
      100% { background: transparent;}
    }
    .carrito-cantidad-btn {
      background: #25D366;
      color: white;
      border: none;
      border-radius: 3px;
      width: 28px;
      height: 28px;
      font-size: 1.1em;
      cursor: pointer;
      margin: 0 2px;
      transition: background 0.2s;
    }
    .carrito-cantidad-btn:active {
      background: #1ebd5a;
    }
    .carrito-cantidad-btn[disabled] {
      background: #ccc;
      cursor: not-allowed;
    }
    /* Responsive */
    @media (max-width: 800px) {
      #productos { gap: 8vw; }
      .producto { max-width: 96vw; }
      #carrito { padding: 18px 2vw; }
    }
    @media (max-width: 600px) {
      #resumenTotales { padding: 14px 6vw; font-size: 1em; }
      #carrito { padding-left: 2vw; padding-right: 2vw; }
    }
    /* Flotante contador */
    #carritoFlotante {
      position: fixed;
      bottom: 26px;
      right: 22px;
      background: #25d366;
      color: #fff;
      border-radius: 50%;
      width: 54px;
      height: 54px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 2em;
      box-shadow: 0 4px 18px #25d36655;
      cursor: pointer;
      z-index: 1000;
      border: 3px solid #fff;
      transition: box-shadow 0.2s;
    }
    #carritoFlotante.pulse {
      animation: pulse 0.5s;
    }
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 #25d36688;}
      100% { box-shadow: 0 0 18px 12px #25d36600;}
    }
    #contadorCarrito {
      background: #fff;
      color: #25d366;
      border-radius: 14px;
      font-size: 1em;
      font-weight: bold;
      padding: 1px 8px;
      position: absolute;
      top: 8px;
      right: 8px;
    }
    /* Modal resumen pedido */
    #modalResumen {
      display: none;
      position: fixed;
      top: 0; left: 0; width: 100vw; height: 100vh;
      background: #0008;
      justify-content: center;
      align-items: center;
      z-index: 3000;
    }
    #modalResumen .contenido {
      background: #fff;
      max-width: 370px;
      border-radius: 16px;
      padding: 25px 20px 20px 20px;
      box-shadow: 0 2px 18px #25d36644;
      text-align: center;
    }
    #modalResumen h3 { margin-top: 0; }
    #modalResumen button {
      background: #25d366;
      color: #fff;
      border: none;
      border-radius: 5px;
      padding: 8px 18px;
      margin: 10px 8px 0 8px;
      font-size: 1em;
      cursor: pointer;
      transition: background 0.2s;
    }
    #modalResumen button:last-child {
      background: #e74c3c;
    }
    #modalResumen button:hover { opacity: 0.9; }
  </style>
</head>


  <body>
  <header>
    <h1>Dulce Vida - Panetelas y Reposter√≠a</h1>
    <div style="font-size:1.2em; margin-top:6px;">¬°Haz tu pedido y rec√≠belo en casa!</div>
  </header>
  <main>
    <!-- Productos -->
    <section id="productos">
      <!-- Los productos se generan por JS -->
    </section>

    <!-- Carrito de compras -->
    <section id="carrito">
      <h2>Carrito üõí</h2>
      <ul id="listaCarrito" style="padding-left: 20px; min-height: 55px;"></ul>
      <div id="carritoVacio" style="display:none; text-align:center; color:#888; margin-top:20px;">
        Tu carrito est√° vac√≠o. ¬°Agrega algo delicioso!
      </div>
      <button id="vaciarCarrito">
        Vaciar carrito
      </button>
      <div id="resumenTotales">
        <p>Subtotal: <span id="totalCarrito">0</span> CUP</p>
        <p>Env√≠o: <span id="tarifaReparto">0</span> CUP</p>
        <p style="font-size:1.2em;"><strong>Total: <span id="totalFinal">0</span> CUP</strong></p>
      </div>
    </section>
    <!-- Bot√≥n flotante del carrito -->
    <div id="carritoFlotante" onclick="window.scrollTo({top: document.getElementById('carrito').offsetTop-40, behavior: 'smooth'});">
      üõí
      <span id="contadorCarrito">0</span>
    </div>
    <!-- Modal resumen de pedido -->
    <div id="modalResumen">
      <div class="contenido">
        <h3>¬øConfirmar pedido?</h3>
        <div id="resumenPedido"></div>
        <button id="btnConfirmarEnviar">S√≠, enviar</button>
        <button onclick="cerrarModalResumen()">Cancelar</button>
      </div>
    </div>
  </main>
  </body>


  <!-- PARTE 3: Script principal para productos, carrito y mejoras -->
<script>
// ========== DATOS DE EJEMPLO ==========
// Puedes modificar estos productos a tu gusto
const productos = [
  { id: 1, nombre: "Panetela Cl√°sica", precio: 130, img: "https://images.unsplash.com/photo-1504674900247-0877df9cc836?fit=crop&w=300&q=80" },
  { id: 2, nombre: "Panetela de Coco", precio: 150, img: "https://images.unsplash.com/photo-1504674900247-0877df9cc836?fit=crop&w=300&q=80" },
  { id: 3, nombre: "Cake de Chocolate", precio: 190, img: "https://images.unsplash.com/photo-1504674900247-0877df9cc836?fit=crop&w=300&q=80" },
  { id: 4, nombre: "Flan Casero", precio: 80, img: "https://images.unsplash.com/photo-1504674900247-0877df9cc836?fit=crop&w=300&q=80" }
];

// Opcional: para simular stock y productos agotados
const estadosProductos = {
  "Panetela Cl√°sica": "Disponible",
  "Panetela de Coco": "Agotado",
  "Cake de Chocolate": "Disponible",
  "Flan Casero": "Disponible"
};

// ========== VARIABLES DE ESTADO ==========
let carrito = JSON.parse(localStorage.getItem('carrito') || '[]');
let cantidadesSeleccionadas = {};

// ========== GENERAR PRODUCTOS ==========
function renderizarProductos() {
  const cont = document.getElementById('productos');
  cont.innerHTML = "";
  productos.forEach(prod => {
    const agotado = (estadosProductos[prod.nombre] && estadosProductos[prod.nombre].toLowerCase().includes('agotado'));
    const div = document.createElement('div');
    div.className = 'producto' + (agotado ? ' agotado' : '');
    div.innerHTML = `
      <img src="${prod.img}" alt="${prod.nombre}">
      <h3>${prod.nombre}</h3>
      <div style="font-weight:bold;">${prod.precio} CUP</div>
      ${agotado ? '<div class="etiqueta">Agotado</div>' : ''}
      <div class="control-cantidad">
        <button onclick="cambiarCantidad(${prod.id},-1)" ${agotado ? 'disabled' : ''}>-</button>
        <span id="cantidad-${prod.id}">0</span>
        <button onclick="cambiarCantidad(${prod.id},1)" ${agotado ? 'disabled' : ''}>+</button>
      </div>
      <button onclick="agregarAlCarritoDesdeBoton(${prod.id})" ${agotado ? 'disabled' : ''}>Agregar</button>
    `;
    cont.appendChild(div);
    cantidadesSeleccionadas[prod.id] = 0;
  });
}

// ========== CAMBIAR CANTIDAD SELECCIONADA POR PRODUCTO ==========
function cambiarCantidad(id, delta) {
  cantidadesSeleccionadas[id] = Math.max(0, (cantidadesSeleccionadas[id] || 0) + delta);
  document.getElementById(`cantidad-${id}`).textContent = cantidadesSeleccionadas[id];
}

// ========== AGREGAR AL CARRITO DESDE BOT√ìN ==========
function agregarAlCarritoDesdeBoton(id) {
  const cantidad = cantidadesSeleccionadas[id] || 0;
  if (cantidad === 0) {
    alert("Selecciona al menos una unidad para agregar.");
    return;
  }
  const producto = productos.find(p => p.id === id);
  let existe = carrito.find(i => i.id === id);
  if (existe) {
    existe.cantidad += cantidad;
    setTimeout(() => {
      const items = document.querySelectorAll('#listaCarrito li');
      items.forEach(li => {
        if (li.textContent.includes(producto.nombre)) {
          li.classList.add('carrito-item-animado');
          setTimeout(() => li.classList.remove('carrito-item-animado'), 500);
        }
      });
    }, 50);
  } else {
    carrito.push({ ...producto, cantidad });
  }
  cantidadesSeleccionadas[id] = 0;
  document.getElementById(`cantidad-${id}`).textContent = 0;
  actualizarCarrito();
  const carritoFlot = document.getElementById('carritoFlotante');
  carritoFlot.classList.remove('pulse');
  void carritoFlot.offsetWidth;
  carritoFlot.classList.add('pulse');
  setTimeout(() => carritoFlot.classList.remove('pulse'), 500);
}

// ========== QUITAR PRODUCTO DEL CARRITO ==========
function quitarDelCarrito(id) {
  carrito = carrito.filter(i => i.id !== id);
  actualizarCarrito();
}

// ========== CAMBIAR CANTIDAD DESDE EL CARRITO ==========
function cambiarCantidadCarrito(id, delta) {
  const prod = carrito.find(i => i.id === id);
  if (!prod) return;
  prod.cantidad += delta;
  if (prod.cantidad <= 0) quitarDelCarrito(id);
  else actualizarCarrito();
}

// ========== ACTUALIZAR CARRITO Y MOSTRAR ==========
function actualizarCarrito() {
  const listaCarrito = document.getElementById('listaCarrito');
  const vaciarCarritoBtn = document.getElementById('vaciarCarrito');
  const carritoVacioMsg = document.getElementById('carritoVacio');
  listaCarrito.innerHTML = '';
  let subtotal = 0;
  let totalItems = 0;
  carrito.forEach(item => {
    subtotal += item.precio * item.cantidad;
    totalItems += item.cantidad;
    const agotado = (estadosProductos[item.nombre] && estadosProductos[item.nombre].toLowerCase().includes('agotado'));
    const li = document.createElement('li');
    li.style.textAlign = 'left';
    li.style.marginBottom = '10px';
    li.className = 'carrito-item-animado';
    li.innerHTML = `
      <strong>${item.nombre}</strong>
      <div style="display:inline-block; margin-left:8px;">
        <button class="carrito-cantidad-btn" onclick="cambiarCantidadCarrito(${item.id}, -1)" ${item.cantidad <= 1 ? 'disabled' : ''} aria-label="Disminuir cantidad">-</button>
        <span style="margin:0 6px; font-weight:bold;">${item.cantidad}</span>
        <button class="carrito-cantidad-btn" onclick="cambiarCantidadCarrito(${item.id}, 1)" ${agotado ? 'disabled' : ''} aria-label="Aumentar cantidad">+</button>
      </div>
      <span style="margin-left:14px;">${item.precio * item.cantidad} CUP</span>
      <button onclick="quitarDelCarrito(${item.id})" title="Quitar" style="background:none; color:#e74c3c; border:none; font-size:1.2em; cursor:pointer;" aria-label="Quitar producto">&times;</button>
      ${agotado ? '<span style="color:#e74c3c; font-size:0.9em;"> (Agotado)</span>' : ''}
    `;
    listaCarrito.appendChild(li);
    setTimeout(() => li.classList.remove('carrito-item-animado'), 500);
  });
  document.getElementById('totalCarrito').textContent = subtotal;
  actualizarTarifa();
  document.getElementById('contadorCarrito').textContent = totalItems;
  actualizarEstadoBotonEnviar();
  if (carrito.length === 0) {
    carritoVacioMsg.style.display = 'block';
    vaciarCarritoBtn.style.display = 'none';
  } else {
    carritoVacioMsg.style.display = 'none';
    vaciarCarritoBtn.style.display = 'inline-block';
  }
  localStorage.setItem('carrito', JSON.stringify(carrito));
}

// ========== BOT√ìN VACIAR CARRITO ==========
document.getElementById('vaciarCarrito').onclick = function() {
  if (carrito.length === 0) return;
  if (confirm('¬øSeguro que quieres vaciar tu carrito? Esta acci√≥n no se puede deshacer.')) {
    carrito = [];
    actualizarCarrito();
    localStorage.removeItem('carrito');
  }
};

// ========== SINCRONIZACI√ìN ENTRE PESTA√ëAS ==========
window.addEventListener('storage', function(e) {
  if (e.key === 'carrito') {
    try {
      carrito = JSON.parse(localStorage.getItem('carrito') || '[]');
      actualizarCarrito();
    } catch { /* ignore */ }
  }
});

// ========== TARIFA DE ENV√çO (puedes ajustar l√≥gica) ==========
function actualizarTarifa() {
  const subtotal = carrito.reduce((sum, item) => sum + item.precio * item.cantidad, 0);
  let tarifa = subtotal === 0 ? 0 : 40; // Por ejemplo: 40 CUP fijo si hay pedido
  document.getElementById('tarifaReparto').textContent = tarifa;
  document.getElementById('totalFinal').textContent = subtotal + tarifa;
}

// ========== BOT√ìN ENVIAR PEDIDO POR WHATSAPP ==========
function actualizarEstadoBotonEnviar() {
  // Si tienes un bot√≥n de enviar, puedes habilitar/deshabilitar aqu√≠ seg√∫n el carrito
}

// ========== MODAL RESUMEN DE PEDIDO ==========
function abrirModalResumen() {
  const modal = document.getElementById('modalResumen');
  const resumen = document.getElementById('resumenPedido');
  let texto = '<ul style="text-align:left;">';
  carrito.forEach(p => texto += `<li>${p.cantidad} x ${p.nombre} = <b>${p.precio * p.cantidad} CUP</b></li>`);
  texto += '</ul>';
  texto += `<div style="margin-top:10px;">Subtotal: <b>${document.getElementById('totalCarrito').textContent} CUP</b><br>Env√≠o: <b>${document.getElementById('tarifaReparto').textContent} CUP</b><br>Total: <b>${document.getElementById('totalFinal').textContent} CUP</b></div>`;
  resumen.innerHTML = texto;
  modal.style.display = "flex";
}
function cerrarModalResumen() {
  document.getElementById('modalResumen').style.display = "none";
}

// ========== INICIALIZACI√ìN ==========
renderizarProductos();
actualizarCarrito();

// Si tienes un bot√≥n de enviar pedido, puedes enlazarlo as√≠:
// document.getElementById('btnEnviarPedido').onclick = abrirModalResumen;
document.getElementById('btnConfirmarEnviar').onclick = function() {
  alert("¬°Pedido enviado por WhatsApp! (Aqu√≠ puedes poner la integraci√≥n real con WhatsApp)");
  cerrarModalResumen();
};

  

// ========== ABRIR Y CERRAR MODAL DESDE EL CARRITO ==========
// (puedes enlazar abrirModalResumen a alg√∫n bot√≥n de "enviar pedido" si lo deseas)
function abrirModalResumen() {
  const modal = document.getElementById('modalResumen');
  const resumen = document.getElementById('resumenPedido');
  let texto = '<ul style="text-align:left;">';
  carrito.forEach(p => texto += `<li>${p.cantidad} x ${p.nombre} = <b>${p.precio * p.cantidad} CUP</b></li>`);
  texto += '</ul>';
  texto += `<div style="margin-top:10px;">Subtotal: <b>${document.getElementById('totalCarrito').textContent} CUP</b><br>Env√≠o: <b>${document.getElementById('tarifaReparto').textContent} CUP</b><br>Total: <b>${document.getElementById('totalFinal').textContent} CUP</b></div>`;
  resumen.innerHTML = texto;
  modal.style.display = "flex";
}
function cerrarModalResumen() {
  document.getElementById('modalResumen').style.display = "none";
}

// Si tienes un bot√≥n de "Enviar pedido", puedes enlazarlo as√≠:
// document.getElementById('btnEnviarPedido').onclick = abrirModalResumen;
document.getElementById('btnConfirmarEnviar').onclick = function() {
  alert("¬°Pedido enviado por WhatsApp! (Aqu√≠ puedes poner la integraci√≥n real con WhatsApp)");
  cerrarModalResumen();
};

// OPCIONAL: Puedes agregar un bot√≥n "Enviar pedido" donde lo desees
// Ejemplo: <button onclick="abrirModalResumen()">Enviar pedido</button>

// Inicializaci√≥n al recargar
renderizarProductos();
actualizarCarrito();
</script>

</html>


  
